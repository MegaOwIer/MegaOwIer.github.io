---
title: 2015 ICPC EC-Final (Gym 103957) 训练记录
slug: cf-gym-103957
date: 2023-01-10
tags:
  - Binary Search
  - DP
  - Greedy
  - Maths
categories:
  - ICPC
description: EC-Final 2022 赛前例行训练
draft: false
image: pixiv-61597814.jpg
lastmod: 2024-12-27
---

## 正式训练

### A. Boxes and Balls

易知答案一定可以表示为前 $m$ 个自然数的和。二分找出最大的 $m$ 即可。

### L. Multiplication Table

实际上整个矩阵被左上角的坐标 $(x, y)$ 完全确定，而每个给出的数实际上是一个形如 $(x + i)(y + j) = a_{i, j}$ 的条件。

+ 若矩阵中全是 `?`，直接输出 `Yes` 即可。
+ 若非 `?` 的数至少有两个，则一定可以通过解二次方程确定出至多两组可能的 $(x, y)$，分别验证即可。
+ 若非 `?` 的数有且仅有一个，确定其是否可以被分解为两个不太小的因子相乘即可。

上面的后两种情况均可通过枚举因子实现。时间复杂度 $O(T \cdot RC \sqrt{V})$。

{{< highlight-content file="L.cpp" lang="cpp" >}}

### B. Business Cycle

我们考虑沿着环走完一整圈会发生什么。不妨设 $S$ 为环上所有数的和，$m$ 为环上前缀和中的最小值，即 $\displaystyle\min_{1 \leq k \leq n} \sum_{i=1}^{k} V_i$。若我们当前手里的钱是 $x$，一圈之后手里的钱数 $f(x)$ 可表示为
$$
f(x) = \begin{cases}
    x + S, & x + m \geq 0 \newline
    S - m, & x + m < 0
\end{cases}
$$
处理完不是整圈的部分之后暴力沿着 $f$ 的反函数往回跳即可。

这里需要注意有两种情况。不妨设 $p = kn + r$，我们既可以选择跳不超过 $k$ 圈之后走一个不超过 $r$ 的弧段，又可以选择跳不超过 $k - 1$ 圈之后走一个长度任意的弧段。

时间复杂度 $O(Tn)$。

{{< highlight-content file="B.cpp" lang="cpp" >}}

## 赛后补题

### J. Dome and Steles

这个题其实训练还剩 80min 的时候就想出做法了，不过因为没有完全想清楚所有细节导致没写出来。

可以发现每个方块会给半径贡献一个 $\left( d^2 + a^2 + \dfrac{b^2}{4} \right)^{1/2}$ 的下界，其中 $d$ 是球心到方块外立面的距离。

显然，对每个方块取长宽中较小的作为 $a$ 是更好的。其次，当半径确定后，$a^2 + \dfrac{b^2}{4}$ 越大的方块越靠近球心。

我们的想法是二分答案，然后判定能不能放得下所有方块。判定的话注意到球心一定会被某个方块压住，不妨设球心离这个方块两边的长度分别为 $l$ 和 $r$，然后左半序列和右半序列会分别给出 $l$ 和 $r$ 的上界。我们最后只需要判断这两个上界是否与 $l + r = 1$ 相容即可。

时间复杂度 $O(T n \log n)$。

{{< highlight-content file="J.cpp" lang="cpp" >}}

### I. Champions League

很莫名其妙的一个状压 DP。由于对来自相同国家的球队分组有一个很麻烦的规则，我们自然可以想到逐个国家来处理。

同一国家的同一档次的球队在 DP 的过程中很难区分开来，我们索性在 DP 过程中只分配集合，最后再把那些阶乘统一乘进去。这样一来每个国家对 DP 的更新就可以通过逐档次枚举分组来实现。

注意到每个档次枚举的代价至多是 $\displaystyle \binom{8}{4} = 70$，考虑到同一国家的球队至多有 $5$ 个，每个国家的转移代价实际上只有 $10^4$ 数量级。因此总复杂度是可以接受的。

{{< highlight-content file="I.cpp" lang="cpp" >}}

### E. Colorful Floor

实际上手做了之后感觉两三句话说不清楚，因此[新开了一篇文章专门讲这个]({{< ref "/post/cf-gym-103957e" >}})。

---

由于期末考试，南京站之后就没写过代码。南京站我们队打得稀烂，再往前杭州站和南京站之间的那次训练也因为我得病被迫取消。这么其实算来已经有一个多月没好好写代码了。

这次训练打得磕磕绊绊的，先权当找回状态吧。希望之后能好一些。

补题的话 DFM 训练时候队友解决了，其他题感觉赛场上我们也不太可能做出来，就先咕了。
